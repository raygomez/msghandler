{{extend 'layout.html'}}
<script type="text/javascript" src="/{{=request.application}}/static/js/jquery.timeago.js"></script>
<script>
    $(function(){
        $('.timestamp').timeago()             
    })
</script>
Things to Do
<ol>
<li>users can view own events</li>
<li>users can view events from a referral where they commented (or where they are creator)</li>
<li>users can view new message events from a group where they are member of</li>
<li><del>CUD Tag</del></li>
<li><del>CUD Group</del></li>
<li><del>CUD Contact</del></li>
<li><del>C Message</del></li>
<li><del>CUD User</del></li>
<li>CD msg_tag</li>
<li>CD msg_group</li>
<li></li>
</ol>
Sample events
<ol>
<li><a href="#">Jose Rizal</a> sent an <a href="#">email referral</a>. <abbr href="#" class="timestamp" title="2011-05-22T09:24:17Z" /></li>
<li><a href="#">Jose Rizal</a> sent an <a href="#">SMS reply</a>. <abbr href="#" class="timestamp" title="2008-07-17T09:24:17Z" /></li>
<li>(kaya lang mukhang mahirap isama sa ordering) <a href="#">Jose Rizal</a> sent an <a href="#">SMS reply</a> to <a href="#">Andres Bonifacio's</a> <a href="#">SMS referral</a>. <abbr href="#" class="timestamp" title="2008-07-17T09:24:17Z" /></li>
<li><a href="#">Jose Rizal</a> created new tag <a href="#">Telehealth</a>. <abbr href="#" class="timestamp" title="2008-07-17T09:24:17Z" /></li>
<li><a href="#">You</a> deleted tag <a href="#">Admin</a>. <abbr href="#" class="timestamp" title="2008-07-17T09:24:17Z" /></li>
<li><a href="#">Jose Rizal</a> modified tag <a href="#">Telehealth</a>. <abbr href="#" class="timestamp" title="2008-07-17T09:24:17Z" /></li>
<li><a href="#">You</a> deleted tag <a href="#">Admin</a>. <abbr href="#" class="timestamp" title="2008-07-17T09:24:17Z" /></li>
<li></li>
</ol>

<table>
{{for evnt in evnts:}}

{{if evnt['table'] == 'tag':}}
    {{if evnt['access'] == 'create':}}
        <tr><td>{{=evnt['user']}} added a new tag {{=A(evnt['item'].name, _href=URL('tags')) if evnt['item'] else '[was deleted]'}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span></td></tr>
    {{elif evnt['access'] == 'update':}}
        <tr><td>{{=evnt['user']}} updated the tag {{=A(evnt['item'].name, _href=URL('tags')) if evnt['item'] else '[was deleted]'}} [{{=evnt['details']}}]. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td></tr>
        {{elif evnt['access'] == 'delete':}}
<tr><td>{{=evnt['user']}} deleted the tag {{=evnt['details']}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td>
    {{pass}}

{{elif evnt['table'] == 'auth_group':}}
    {{if evnt['access'] == 'create':}}
        <tr><td>{{=evnt['user']}} added a new group {{=A(evnt['item'].role, _href=URL('groups')) if evnt['item'] else '[was deleted]'}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span></td></tr>
    {{elif evnt['access'] == 'update':}}
        <tr><td>{{=evnt['user']}} updated the group {{=A(evnt['item'].role, _href=URL('groups')) if evnt['item'] else '[was deleted]'}} [{{=evnt['details']}}]. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td></tr>
    {{elif evnt['access'] == 'delete':}}
        <tr><td>{{=evnt['user']}} deleted the group {{=evnt['details']}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td>
    {{pass}}

{{elif evnt['table'] == 'contact':}}
    {{if evnt['access'] == 'create':}}
        <tr><td>{{=evnt['user']}} added a new contact {{=A(evnt['item'].name, _href=URL('contacts')) if evnt['item'] else '[was deleted]'}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span></td></tr>
    {{elif evnt['access'] == 'update':}}
        <tr><td>{{=evnt['user']}} updated the contact {{=A(evnt['item'].name, _href=URL('contacts')) if evnt['item'] else '[was deleted]'}} [{{=evnt['details']}}]. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td></tr>
    {{elif evnt['access'] == 'delete':}}
        <tr><td>{{=evnt['user']}} deleted the contact {{=evnt['details']}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td>
    {{pass}}

{{elif evnt['table'] == 'auth_user':}}
    {{if evnt['access'] == 'create':}}
        <tr><td>{{=evnt['user']}} added a new user {{=A(evnt['item'].email, _href=URL('show_user', args=evnt['item'].id)) if evnt['item'] else '[was deleted]'}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span></td></tr>
    {{elif evnt['access'] == 'update':}}
        <tr><td>{{=evnt['user']}} updated the user {{=A(evnt['item'].email, _href=URL('show_user'), args=evnt['item'].id) if evnt['item'] else '[was deleted]'}} [{{=evnt['details']}}]. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td></tr>
    {{elif evnt['access'] == 'delete':}}
        <tr><td>{{=evnt['user']}} deleted the user {{=evnt['details']}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span> </td>
    {{pass}}

{{elif evnt['table'] == 'msg':}}
    {{if evnt['access'] == 'create':}}
        <tr><td>{{=evnt['user']}} added a new message {{=A(evnt['item'].subject, _href=URL('read_message', args=evnt['item'].id)) if evnt['item'] else '[was deleted]'}}. <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span></td></tr>
    {{pass}}

{{elif evnt['table'] == 'msg_tag':}}
    {{if evnt['access'] == 'create':}}
        <tr><td>{{=evnt['user']}} tagged the message {{=A(evnt['item'].msg_id.subject, _href=URL('read_message', args=evnt['item'].id)) if evnt['item'] else '[was deleted]'}} as {{=A(evnt['item'].tag_id.name, _href=URL('tags')) if evnt['item'] else '[was deleted]'}} . <span class='timestamp' title={{=evnt['timestamp'].isoformat()}}></span></td></tr>
    {{pass}}
    
    
{{pass}}
{{pass}}
</table>
